# ะะฝะฐะปะธะท ัะพััะพัะฝะธั ะฟะพะดัะธะฟะฝะธะบะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะผะฐัะธะฝะฝะพะณะพ ะพะฑััะตะฝะธั

ะญัะพั ะฟัะพะตะบั ะฟัะตะดััะฐะฒะปัะตั ัะพะฑะพะน ัะธััะตะผั ะดะปั ะพะฟัะตะดะตะปะตะฝะธั ัะพััะพัะฝะธั ะฟะพะดัะธะฟะฝะธะบะฐ ะฝะฐ ะพัะฝะพะฒะต ะฐะฝะฐะปะธะทะฐ FFT (ะฑััััะพะณะพ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั ะคัััะต) ะทะฒัะบะพะฒัั ัะธะณะฝะฐะปะพะฒ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ะฝะตะนัะพะฝะฝัั ัะตัะตะน.

## ๐ฏ ะฆะตะปั ะฟัะพะตะบัะฐ

ะกะพะทะดะฐัั ะผะพะดะตะปั ะผะฐัะธะฝะฝะพะณะพ ะพะฑััะตะฝะธั, ะบะพัะพัะฐั ะผะพะถะตั:
- ะะฟัะตะดะตะปััั ัะพััะพัะฝะธะต ะฟะพะดัะธะฟะฝะธะบะฐ ะฒ ะฟัะพัะตะฝัะฐั (0-100%)
- ะะพะบะฐะทัะฒะฐัั ะฟัะพัะตะฝั ะธะทะฝะพัะฐ ะฟะพะดัะธะฟะฝะธะบะฐ
- ะัะฟะพะปัะทะพะฒะฐัั MPS (Metal Performance Shaders) ะดะปั ััะบะพัะตะฝะธั ะพะฑััะตะฝะธั
- ะะฑัะฐะฑะฐััะฒะฐัั ะดะฐะฝะฝัะต FFT ั timestamp ะธ ัะฐััะพัะฐะผะธ
- ะกะพััะฐะฝััั ะธ ะทะฐะณััะถะฐัั ะพะฑััะตะฝะฝัะต ะผะพะดะตะปะธ ะดะปั ะฟะพะฒัะพัะฝะพะณะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
bearing-signal/
โโโ main.py              # ะัะฝะพะฒะฝะพะน ัะฐะนะป ะทะฐะฟััะบะฐ
โโโ models.py            # ะะพะดะตะปะธ ะฝะตะนัะพะฝะฝัั ัะตัะตะน
โโโ dataset.py           # ะะฐะณััะทะบะฐ ะธ ะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั
โโโ training.py          # ะคัะฝะบัะธะธ ะพะฑััะตะฝะธั ะธ ะพัะตะฝะบะธ
โโโ prediction.py        # ะคัะฝะบัะธะธ ะฟัะตะดัะบะฐะทะฐะฝะธั
โโโ visualization.py     # ะะธะทัะฐะปะธะทะฐัะธั ัะตะทัะปััะฐัะพะฒ
โโโ utils.py            # ะฃัะธะปะธัั ะธ ะฝะฐัััะพะนะบะธ
โโโ predict_with_saved_model.py  # ะกะบัะธะฟั ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธะน ั ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปัั
โโโ requirements.txt     # ะะฐะฒะธัะธะผะพััะธ
โโโ .gitignore          # ะัะบะปััะตะฝะธั ะดะปั Git
โโโ README.md           # ะะพะบัะผะตะฝัะฐัะธั
โโโ bearing_analysis_results.png  # ะะตะทัะปััะฐัั ะฒะธะทัะฐะปะธะทะฐัะธะธ
โโโ saved_models/       # ะะฐะฟะบะฐ ั ัะพััะฐะฝะตะฝะฝัะผะธ ะผะพะดะตะปัะผะธ
โ   โโโ bearing_classifier.pth    # ะกะพััะฐะฝะตะฝะฝะฐั ะผะพะดะตะปั
โ   โโโ scaler.pkl               # ะกะพััะฐะฝะตะฝะฝัะน scaler
โ   โโโ pca.pkl                  # ะกะพััะฐะฝะตะฝะฝัะน PCA
โ   โโโ model_metadata.pkl       # ะะตัะฐะดะฐะฝะฝัะต ะผะพะดะตะปะธ
โโโ bad_bearing(0).csv      # ะะฐะฝะฝัะต ะฟะปะพัะพะณะพ ะฟะพะดัะธะฟะฝะธะบะฐ
โโโ normal_bearing(0.5).csv # ะะฐะฝะฝัะต ะฝะพัะผะฐะปัะฝะพะณะพ ะฟะพะดัะธะฟะฝะธะบะฐ
โโโ new_bearing(1).csv      # ะะฐะฝะฝัะต ะฝะพะฒะพะณะพ ะฟะพะดัะธะฟะฝะธะบะฐ
โโโ test_bearing.csv        # ะขะตััะพะฒัะต ะดะฐะฝะฝัะต
```

## ๐ ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ

### 1. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
```bash
pip install -r requirements.txt
```

### 2. ะะฑััะตะฝะธะต ะธ ัะพััะฐะฝะตะฝะธะต ะผะพะดะตะปะธ
```bash
python main.py
```

### 3. ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปะธ ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธะน
```bash
python predict_with_saved_model.py
```

## ๐พ ะกะพััะฐะฝะตะฝะธะต ะธ ะทะฐะณััะทะบะฐ ะผะพะดะตะปะตะน

### ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพััะฐะฝะตะฝะธะต
ะัะธ ะทะฐะฟััะบะต `main.py` ะผะพะดะตะปั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพััะฐะฝัะตััั ะฒ ะฟะฐะฟะบั `saved_models/`:
- `bearing_classifier.pth` - ะฒะตัะฐ ะผะพะดะตะปะธ PyTorch
- `scaler.pkl` - ะฝะพัะผะฐะปะธะทะฐัะพั ะดะฐะฝะฝัั
- `pca.pkl` - ะบะพะผะฟะพะฝะตะฝัั PCA
- `model_metadata.pkl` - ะผะตัะฐะดะฐะฝะฝัะต ะผะพะดะตะปะธ

### ะะฐะณััะทะบะฐ ะผะพะดะตะปะธ ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธะน
```python
from utils import load_saved_model

# ะะฐะณััะทะบะฐ ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปะธ
model, scaler, pca, metadata = load_saved_model("saved_models")

# ะัะฟะพะปัะทะพะฒะฐะฝะธะต ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธะน
if model is not None:
    # ะะฐั ะบะพะด ะดะปั ะฟัะตะดัะบะฐะทะฐะฝะธะน
    pass
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปะธ
```python
from predict_with_saved_model import predict_with_saved_model

# ะะฝะฐะปะธะท ะฝะพะฒะพะณะพ ัะฐะนะปะฐ ะดะฐะฝะฝัั
predict_with_saved_model("path/to/your/data.csv")
```

## ๐จ ะะธะทัะฐะปะธะทะฐัะธั ะผะพะดะตะปะธ

### ะะฒัะพะผะฐัะธัะตัะบะฐั ะฒะธะทัะฐะปะธะทะฐัะธั
ะัะธ ะทะฐะฟััะบะต `main.py` ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะตััั ะฒะธะทัะฐะปะธะทะฐัะธั ะพะฑััะตะฝะฝะพะน ะผะพะดะตะปะธ ะฒ ะฟะฐะฟะบะต `visualizations/`:
- `trained_model_architecture.png` - ะณัะฐัะธัะตัะบะฐั ะฒะธะทัะฐะปะธะทะฐัะธั ะฐััะธัะตะบัััั

### ะััะฝะฐั ะฒะธะทัะฐะปะธะทะฐัะธั
```bash
python model_visualization.py
```

ะกะพะทะดะฐะตั ัะปะตะดัััะธะต ัะฐะนะปั:
- `model_architecture.png` - ะฒะธะทัะฐะปะธะทะฐัะธั ะฑะฐะทะพะฒะพะน ะฐััะธัะตะบัััั
- `saved_model_architecture.png` - ะฒะธะทัะฐะปะธะทะฐัะธั ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปะธ
- `model_diagram.txt` - ัะตะบััะพะฒะฐั ะดะธะฐะณัะฐะผะผะฐ ะฐััะธัะตะบัััั

### ะััะธัะตะบัััะฐ ะผะพะดะตะปะธ
```
ะัะพะดะฝะพะน ัะปะพะน (100 ะฟัะธะทะฝะฐะบะพะฒ ะฟะพัะปะต PCA)
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Linear(100 โ 256)                  โ
โ ReLU                               โ
โ BatchNorm1d(256)                   โ
โ Dropout(0.3)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Linear(256 โ 128)                  โ
โ ReLU                               โ
โ BatchNorm1d(128)                   โ
โ Dropout(0.3)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Linear(128 โ 64)                   โ
โ ReLU                               โ
โ BatchNorm1d(64)                    โ
โ Dropout(0.2)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Linear(64 โ 32)                    โ
โ ReLU                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Linear(32 โ 1)                     โ
โ Sigmoid                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
ะััะพะด (0-1, ะผะฐัััะฐะฑะธััะตััั ะดะพ 0-100%)
```

### ะกัะฐัะธััะธะบะฐ ะผะพะดะตะปะธ
- **ะัะตะณะพ ะฟะฐัะฐะผะตััะพะฒ**: 70,017
- **ะะฑััะฐะตะผัั ะฟะฐัะฐะผะตััะพะฒ**: 70,017
- **ะกะปะพะตะฒ**: 17 (ะฒะบะปััะฐั ะฐะบัะธะฒะฐัะธะธ ะธ ะฝะพัะผะฐะปะธะทะฐัะธั)
- **ะัะพะดะฝะพะน ัะฐะทะผะตั**: 100 ะฟัะธะทะฝะฐะบะพะฒ (ะฟะพัะปะต PCA)
- **ะััะพะด**: 1 ะทะฝะฐัะตะฝะธะต (0-100%)

## ๐ ะะฟะธัะฐะฝะธะต ะดะฐะฝะฝัั

### ะคะพัะผะฐั CSV ัะฐะนะปะพะฒ:
- **ะะตัะฒัะน ััะพะปะฑะตั**: timestamp (ะฒัะตะผั)
- **ะะตัะฒะฐั ัััะพะบะฐ**: ัะฐััะพัั (Hz)
- **ะััะฐะปัะฝัะต ะดะฐะฝะฝัะต**: ะทะฝะฐัะตะฝะธั FFT ะดะปั ะบะฐะถะดะพะน ัะฐััะพัั

### ะะตัะบะธ ัะพััะพัะฝะธะน:
- **0%** - ะะปะพัะพะน ะฟะพะดัะธะฟะฝะธะบ (ััะตะฑัะตั ะทะฐะผะตะฝั)
- **50%** - ะะพัะผะฐะปัะฝัะน ะฟะพะดัะธะฟะฝะธะบ (ััะตะดะฝะธะน ะธะทะฝะพั)
- **100%** - ะะพะฒัะน ะฟะพะดัะธะฟะฝะธะบ (ะพัะปะธัะฝะพะต ัะพััะพัะฝะธะต)

## ๐ง ะััะธัะตะบัััะฐ ะผะพะดะตะปะธ

### ะะตะนัะพะฝะฝะฐั ัะตัั:
- **ะัะพะดะฝะพะน ัะปะพะน**: 100 ะฟัะธะทะฝะฐะบะพะฒ (ะฟะพัะปะต PCA)
- **ะกะบััััะต ัะปะพะธ**: 256 โ 128 โ 64 โ 32 ะฝะตะนัะพะฝะพะฒ
- **ะะบัะธะฒะฐัะธะธ**: ReLU + BatchNorm + Dropout
- **ะััะพะด**: 1 ะฝะตะนัะพะฝ ั Sigmoid (ะผะฐัััะฐะฑะธััะตััั ะดะพ 0-100%)

### ะัะตะดะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั:
1. ะฃะดะฐะปะตะฝะธะต timestamp ะธ ัััะพะบะธ ั ัะฐััะพัะฐะผะธ
2. ะะฑัะฐะฑะพัะบะฐ NaN ะทะฝะฐัะตะฝะธะน
3. ะะฐะผะตะฝะฐ ะทะฐะฟัััั ะฝะฐ ัะพัะบะธ ะฒ ะดะตัััะธัะฝัั ัะธัะปะฐั
4. ะะพัะผะฐะปะธะทะฐัะธั (StandardScaler)
5. ะฃะผะตะฝััะตะฝะธะต ัะฐะทะผะตัะฝะพััะธ (PCA ะดะพ 100 ะบะพะผะฟะพะฝะตะฝั)

## โก ะฃัะบะพัะตะฝะธะต ะพะฑััะตะฝะธั

ะะพะดะตะปั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธัะฟะพะปัะทัะตั:
- **MPS** (Metal Performance Shaders) ะฝะฐ Apple Silicon
- **CUDA** ะฝะฐ NVIDIA GPU
- **CPU** ะบะฐะบ fallback

## ๐ ะะตะทัะปััะฐัั

### ะะตััะธะบะธ ะผะพะดะตะปะธ:
- **ะขะพัะฝะพััั**: 97.58%
- **Precision/Recall**: 0.98/0.98 (ััะตะดะฝะตะต)
- **ะะฑัััะฝะตะฝะฝะฐั ะดะธัะฟะตััะธั PCA**: 60.18%

### ะัะธะผะตั ะฒัะฒะพะดะฐ:
```
ะะตะทัะปััะฐั ะฟัะตะดัะบะฐะทะฐะฝะธั ะดะปั test_bearing.csv:
ะกัะตะดะฝะตะต ะฟัะตะดัะบะฐะทะฐะฝะธะต: 16.55%
ะกะพััะพัะฝะธะต ะฟะพะดัะธะฟะฝะธะบะฐ: ะะปะพัะพะน (0.0%)
ะัะพัะตะฝั ะธะทะฝะพัะฐ ะฟะพะดัะธะฟะฝะธะบะฐ: 83.45%
```

## ๐ ะะพะดัะปะธ

### `models.py`
- `BearingClassifier`: ะะตะนัะพะฝะฝะฐั ัะตัั ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ

### `dataset.py`
- `BearingDataset`: PyTorch ะดะฐัะฐัะตั
- `load_and_preprocess_data()`: ะะฐะณััะทะบะฐ ะธ ะพะฑัะฐะฑะพัะบะฐ ะดะฐะฝะฝัั
- `prepare_data_loaders()`: ะะพะดะณะพัะพะฒะบะฐ DataLoader

### `training.py`
- `get_device()`: ะะฟัะตะดะตะปะตะฝะธะต ััััะพะนััะฒะฐ (MPS/CUDA/CPU)
- `train_model()`: ะะฑััะตะฝะธะต ะผะพะดะตะปะธ
- `evaluate_model()`: ะัะตะฝะบะฐ ะผะพะดะตะปะธ

### `prediction.py`
- `predict_test_bearing()`: ะัะตะดัะบะฐะทะฐะฝะธะต ะดะปั ะฝะพะฒัั ะดะฐะฝะฝัั

### `visualization.py`
- `visualize_results()`: ะกะพะทะดะฐะฝะธะต ะณัะฐัะธะบะพะฒ ะธ ะดะธะฐะณัะฐะผะผ

### `utils.py`
- `set_seeds()`: ะฃััะฐะฝะพะฒะบะฐ seed ะดะปั ะฒะพัะฟัะพะธะทะฒะพะดะธะผะพััะธ
- `print_summary()`: ะัะฒะพะด ะธัะพะณะพะฒะพะณะพ ัะตะทัะผะต
- `print_model_summary()`: ะะพะดัะพะฑะฝัะน ัะฐะผะฐัะธ ะฟะพ ะผะพะดะตะปะธ
- `load_saved_model()`: ะะฐะณััะทะบะฐ ัะพััะฐะฝะตะฝะฝะพะน ะผะพะดะตะปะธ ะธ ะฟัะตะฟัะพัะตััะพัะพะฒ

## ๐ง ะะฐัััะพะนะบะธ

### ะัะฝะพะฒะฝัะต ะฟะฐัะฐะผะตััั:
- **ะญะฟะพัะธ ะพะฑััะตะฝะธั**: 100
- **ะะฐะทะผะตั ะฑะฐััะฐ**: 32
- **Learning rate**: 0.001
- **PCA ะบะพะผะฟะพะฝะตะฝัั**: 100
- **ะะฐะทะผะตั ัะตััะพะฒะพะน ะฒัะฑะพัะบะธ**: 20%

### ะะพัะพะณะธ ะบะปะฐััะธัะธะบะฐัะธะธ:
- **< 25%**: ะะปะพัะพะน ะฟะพะดัะธะฟะฝะธะบ
- **25-75%**: ะะพัะผะฐะปัะฝัะน ะฟะพะดัะธะฟะฝะธะบ
- **> 75%**: ะะพะฒัะน ะฟะพะดัะธะฟะฝะธะบ

## ๐ ะะธะทัะฐะปะธะทะฐัะธั

ะะพะดะตะปั ัะพะทะดะฐะตั ัะฐะนะป `bearing_analysis_results.png` ั:
1. ะัะฐัะธะบะพะผ ะฟะพัะตัั (ะพะฑััะฐััะฐั ะธ ัะตััะพะฒะฐั)
2. ะัะฐัะธะบะพะผ ัะพัะฝะพััะธ
3. ะะฐััะธัะตะน ะพัะธะฑะพะบ
4. ะะฐัะฟัะตะดะตะปะตะฝะธะตะผ ะฟัะตะดัะบะฐะทะฐะฝะธะน

## ๐ค ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะปั ะฐะฝะฐะปะธะทะฐ ะฝะพะฒัั ะดะฐะฝะฝัั:
1. ะะพะผะตััะธัะต CSV ัะฐะนะป ั ะดะฐะฝะฝัะผะธ ะฒ ะฟะฐะฟะบั ะฟัะพะตะบัะฐ
2. ะะฑะฝะพะฒะธัะต ะฟััั ะฒ `prediction.py`
3. ะะฐะฟัััะธัะต `python main.py`

### ะะปั ะธะทะผะตะฝะตะฝะธั ะผะพะดะตะปะธ:
1. ะััะตะดะฐะบัะธััะนัะต ะฐััะธัะตะบัััั ะฒ `models.py`
2. ะะฐัััะพะนัะต ะณะธะฟะตัะฟะฐัะฐะผะตััั ะฒ `training.py`
3. ะะตัะตะทะฐะฟัััะธัะต ะพะฑััะตะฝะธะต

## ๐ ะะธัะตะฝะทะธั

ะญัะพั ะฟัะพะตะบั ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ะดะปั ะพะฑัะฐะทะพะฒะฐัะตะปัะฝัั ะธ ะธััะปะตะดะพะฒะฐัะตะปััะบะธั ัะตะปะตะน. 